# Deployment Guide - Expense Tracker

## Option 1: Render.com (EASIEST - Recommended)

### Prerequisites
- GitHub account
- Render.com account (free)
- Your Google Sheets service account JSON

### Steps

#### 1. Push to GitHub
```bash
git init
git add .
git commit -m "Initial commit"
git branch -M main
git remote add origin https://github.com/YOUR_USERNAME/expense-tracker.git
git push -u origin main
```

#### 2. Deploy on Render
1. Go to https://render.com/
2. Click **New +** → **Web Service**
3. Connect your GitHub repository
4. Render will auto-detect settings from `render.yaml`
5. Click **Create Web Service**

#### 3. Add Environment Variables
In Render dashboard, go to **Environment** tab and add:

**Required:**
```
OAUTH_SERVER_URL=<your-oauth-server-url>
VITE_APP_ID=<your-app-id>
VITE_OAUTH_PORTAL_URL=<your-oauth-portal-url>
GOOGLE_SERVICE_ACCOUNT_JSON=<paste-entire-json-here>
```

**Optional (if not using OAuth):**
```
MOCK_OAUTH=true
MOCK_OAUTH_PORT=4000
```

#### 4. Share Google Sheet
Share your Google Sheet with the service account email:
`sheets-api-service-account@investorpython.iam.gserviceaccount.com`

#### 5. Deploy
Click **Manual Deploy** → **Deploy latest commit**

Your app will be live at: `https://expense-tracker-xxxx.onrender.com`

---

## Option 2: Railway.app

### Steps
1. Push code to GitHub
2. Go to https://railway.app/
3. Click **New Project** → **Deploy from GitHub repo**
4. Select your repository
5. Add environment variables in Settings
6. Railway auto-deploys on push

**Cost:** $5/month free credit, then ~$5-10/month

---

## Option 3: Vercel (Frontend Only)

If you want to deploy just the frontend:

```bash
npm i -g vercel
vercel --prod
```

You'll need to deploy the backend separately (Render/Railway recommended).

---

## Environment Variables Reference

### Required for Production
| Variable | Description | Example |
|----------|-------------|---------|
| `NODE_ENV` | Environment mode | `production` |
| `JWT_SECRET` | Session signing key | Auto-generated by Render |
| `OAUTH_SERVER_URL` | OAuth backend URL | `https://auth.example.com` |
| `VITE_APP_ID` | Your app ID | `your-app-id` |
| `VITE_OAUTH_PORTAL_URL` | OAuth portal URL | `https://portal.example.com` |
| `GOOGLE_SERVICE_ACCOUNT_JSON` | Google Sheets credentials | Full JSON object |

### Optional
| Variable | Description | Default |
|----------|-------------|---------|
| `PORT` | Server port | `3000` |
| `VITE_APP_TITLE` | App title | `Expense Tracker` |
| `VITE_APP_LOGO` | App logo URL | Placeholder |
| `DATABASE_URL` | MySQL connection string | In-memory fallback |
| `MOCK_OAUTH` | Use mock OAuth for testing | `false` |

---

## Troubleshooting

### Build fails
- Ensure Node.js version is 18+ in Render settings
- Check `pnpm-lock.yaml` is committed

### OAuth not working
- Verify `VITE_OAUTH_PORTAL_URL` matches your OAuth provider
- Check redirect URIs in OAuth provider settings

### Google Sheets errors
- Confirm service account email has Editor access to sheet
- Verify `GOOGLE_SERVICE_ACCOUNT_JSON` is valid JSON (no line breaks in dashboard)

### App won't load
- Check Render logs: Dashboard → Logs tab
- Ensure all required env vars are set
- Verify build completed successfully

---

## Cost Estimate

| Platform | Free Tier | Paid |
|----------|-----------|------|
| **Render** | ✅ Free (sleeps after 15min) | $7/month always-on |
| **Railway** | ✅ $5 credit/month | ~$5-10/month |
| **Vercel** | ✅ Hobby (frontend only) | $20/month Pro |

**Recommendation:** Start with Render free tier, upgrade to $7/month if you need 24/7 uptime.

